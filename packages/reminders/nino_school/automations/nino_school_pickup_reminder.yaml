# Nino school pickup reminder
#
automation:
  - id: "nino_school_pickup_reminder"
    alias: "Nino School Pickup Reminder"
    mode: "single"
    initial_state: on
    trigger:
      # 20 mins before end
      - platform: calendar
        event: end
        entity_id: calendar.ninos_school_day
        offset: -00:20:00
    condition:
      # Nino school day boolean is ON
      - condition: state
        entity_id: input_boolean.nino_school_day
        state: "on"
    action:
      # Call the announcement engine
      - service: script.general_announcement
        data:
          speech_message: >-
            {{
              [
                "Schools out! Time to pick up Nino!",
                "Hey there! It's time to pickup Nino from school.",
                "Dont forget to pick up Nino from school!",
                "Nino's school day is almost over, time to pick him up."
              ] | random
            }}
          media_players: "auto"
          sound: "school-bell-chime"

      # Notify the family via push
      - service: notify.ios_family
        data:
          message: School will be over soon, it's time to pick up Nino from school.
          title: Nino's school is ending soon
